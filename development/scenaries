alter table products
    drop column price;

alter table products
    drop column description;

alter table products
    drop column image;

create table Menu
(
    id          int not null,
    supplier_id int null,
    constraint Menu_pk
        primary key (id),
    constraint Menu_suppliers_id_fk
        foreign key (supplier_id) references suppliers (id)
);

rename table Menu to menu;

create table menu_products
(
    product_id int   not null,
    menu_id    int   not null,
    price      float not null,
    image      text  not null
);

alter table menu
    add created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    add updated_at TIMESTAMP ON UPDATE CURRENT_TIMESTAMP;


alter table menu_products
    add created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    add updated_at TIMESTAMP ON UPDATE CURRENT_TIMESTAMP;

alter table menu_products
    add constraint menu_products_products_id_fk
        foreign key (product_id) references products (id);

alter table menu_products
    add constraint menu_products_menu_id_fk
        foreign key (menu_id) references menu (id);

alter table ingredients
    modify name VARCHAR(50) not null;

create unique index ingredients_name_uindex
    on ingredients (name);


alter table products_ingredients
    add constraint products_ingredients_ingredients_id_fk
        foreign key (ingredient_id) references ingredients (id);

alter table products_ingredients
    add constraint products_ingredients_products_id_fk
        foreign key (product_id) references products (id);

alter table products_category
    drop foreign key products_category_products_id_fk;

alter table products_ingredients
    drop foreign key products_ingredients_products_id_fk;

alter table products_suppliers
    drop foreign key products_suppliers_products_id_fk;

alter table orders_products
    drop foreign key orders_products_products_id_fk;

alter table menu_products
    drop foreign key menu_products_products_id_fk;

alter table products
    drop primary key;

create unique index suppliers_categories_name_uindex
    on suppliers_categories (name);


alter table products
    add constraint products_pk
        primary key (id);

alter table products
    modify id int auto_increment;

alter table menu_products
    add constraint menu_products_products_id_fk
        foreign key (product_id) references products (id);

alter table orders_products
    add constraint orders_products_products_id_fk
        foreign key (product_id) references products (id);

alter table products_category
    add constraint products_category_products_id_fk
        foreign key (product_id) references products (id);

alter table products_suppliers
    add constraint products_suppliers_products_id_fk
        foreign key (product_id) references products (id);

alter table products_ingredients
    add constraint products_ingredients_products_id_fk
        foreign key (product_id) references products (id);

alter table products
    add category int not null after name;

drop table products_category;

alter table orders_products
    modify purchase_price float not null after numbers_of_product;

alter table orders
    modify status varchar(100) not null;

alter table products_suppliers
    add external_supplier_id int not null;

alter table products_suppliers
    add external_product_id int null;


alter table products
    add external_id int not null;

alter table suppliers
    add external_id int null after image;

alter table products_suppliers
    modify external_product_id int null after supplier_id;

alter table products_suppliers
    modify external_supplier_id int not null after external_product_id;

alter table products
    modify external_id int not null after category;



